<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Mr Apple Store</title>
<style>

body {
    font-family: Arial;
    background:#fff;
    margin:0;
}

/* Ù‡ÙŠØ¯Ø± */
header {
    background:#111;
    color:#fff;
    padding:12px 18px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

header .logo img {
    height:55px;
}

.cart-link {
    color:#fff;
    font-size:16px;
    text-decoration:none;
    position:relative;
}
#cartCount {
    display:none;
    background:#ff4444;
    color:#fff;
    padding:2px 6px;
    border-radius:50%;
    font-size:12px;
    position:absolute;
    top:-6px;
    right:-10px;
}

/* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
.products {
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(230px,1fr));
    gap:20px;
    padding:20px;
}

.card {
    background:#fff;
    border-radius:12px;
    padding:12px;
    box-shadow:0 3px 8px rgba(0,0,0,0.1);
    text-align:center;
}

.card img {
    width:100%;
    border-radius:10px;
}

.card h3 {
    font-size:18px;
    margin:10px 0;
}

.badge-status {
    display:inline-block;
    padding:4px 10px;
    border-radius:999px;
    font-size:12px;
    margin-top:6px;
}

.badge-available {
    background:#e6ffed;
    color:#137333;
}

.badge-out {
    background:#ffe6e6;
    color:#b00020;
}

.detail-btn {
    display:block;
    margin-top:10px;
    padding:10px;
    background:#ff7a00;
    color:white;
    border-radius:8px;
    font-size:15px;
    text-decoration:none;
}

/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
.section-buttons {
    text-align:center;
    margin:20px 0;
}
.section-buttons button {
    padding:15px 22px;
    margin:5px;
    border:none;
    border-radius:18px;
    cursor:pointer;
    background:#333;
    color:#fff;
}
.section-buttons button.active {
    background:#ff7a00;
}

/* Ø§Ù„ÙÙ„Ø§ØªØ± */
.filters-bar {
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    padding:0 20px 15px;
}

.filters-bar input,
.filters-bar select {
    padding:10px;
    font-size:14px;
    border-radius:8px;
    border:1px solid #ccc;
}

</style>
</head>
<body>

<header>
    <div class="logo">
        <img src="images/logo.png">
    </div>

    <a href="cart.html" class="cart-link">
        ğŸ›’ Ø§Ù„Ø³Ù„Ø©
        <span id="cartCount">0</span>
    </a>
</header>

<!-- Ø£Ø²Ø±Ø§Ø± Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø³Ù… -->
<div class="section-buttons">
    <button id="btnApple" onclick="switchCategory('apple')" class="active">Ù…Ù†ØªØ¬Ø§Øª Apple</button>
    <button id="btnSamsung" onclick="switchCategory('samsung')">Ù…Ù†ØªØ¬Ø§Øª Samsung</button>
    <button id="btnAccessories" onclick="switchCategory('accessories')">Ø§Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª</button>
</div>

<!-- Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…ÙˆØ­Ø¯Ø© -->
<div class="filters-bar">

    <input id="searchInput" type="text" placeholder="Ø¨Ø­Ø«..." oninput="applyUnifiedFilter()">

    <select id="typeFilter" onchange="applyUnifiedFilter()">
        <option value="">ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
    </select>

    <select id="statusFilter" onchange="applyUnifiedFilter()">
        <option value="">Ø§Ù„Ø­Ø§Ù„Ø©: Ø§Ù„ÙƒÙ„</option>
        <option value="available">Ù…ØªÙˆÙØ± ÙÙ‚Ø·</option>
        <option value="out">ØºÙŠØ± Ù…ØªÙˆÙØ± ÙÙ‚Ø·</option>
    </select>

</div>

<!-- 3 Ø£Ù‚Ø³Ø§Ù… Ø«Ø§Ø¨ØªØ© -->
<section id="apple" class="products"></section>
<section id="samsung" class="products" style="display:none;"></section>
<section id="accessories" class="products" style="display:none;"></section>

<script src="cart.js"></script>

<script>
// Ø±Ø§Ø¨Ø· Google Sheet
const SHEET_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vQy4WWb2dGNoPn7G0mirIaYLF0p80wjsO7X7uEKMiFgubBXvN_QxiPBwl4HrAcotkjBkZ98UDf_GoST/pub?output=csv";

let allProducts = [];
let currentCategory = "apple";

// ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (Apple + Samsung + Accessories)
async function loadAllProducts() {
    const res = await fetch(SHEET_URL);
    const text = await res.text();
    const lines = text.trim().split("\n");
    lines.shift(); // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†

    allProducts = [];

    lines.forEach(line => {
        const cols = line.split(",");

        const category = (cols[1] || "").trim().toLowerCase();
        const name     = (cols[2] || "").trim();
        const html     = (cols[3] || "").trim();
        const image    = (cols[4] || "").trim();
        const status   = (cols[7] || "").trim();
        const type     = (cols[8] || "").trim();

        if (!name) return;

        allProducts.push({
            category,
            name,
            html,
            image,
            type,
            statusKey: status === "Ù…ØªÙˆÙØ±" ? "available" : "out",
            statusRaw: status
        });
    });

    buildTypeList();
    applyUnifiedFilter();
}

// ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ Ù„Ù„ÙÙ„Ø§ØªØ±
function buildTypeList() {
    const used = new Set();
    allProducts.forEach(p => { if (p.type) used.add(p.type); });

    const sel = document.getElementById("typeFilter");
    sel.innerHTML = `<option value="">ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>`;

    used.forEach(t => {
        sel.innerHTML += `<option value="${t}">${t}</option>`;
    });
}

// ØªØºÙŠÙŠØ± Ø§Ù„Ù‚Ø³Ù…
function switchCategory(cat) {
    currentCategory = cat;

    document.querySelectorAll(".section-buttons button").forEach(b => b.classList.remove("active"));

    if (cat === "apple") document.getElementById("btnApple").classList.add("active");
    if (cat === "samsung") document.getElementById("btnSamsung").classList.add("active");
    if (cat === "accessories") document.getElementById("btnAccessories").classList.add("active");

    document.getElementById("apple").style.display = "none";
    document.getElementById("samsung").style.display = "none";
    document.getElementById("accessories").style.display = "none";

    document.getElementById(cat).style.display = "grid";

    applyUnifiedFilter();
}

// ÙÙ„ØªØ± Ù…ÙˆØ­Ø¯ Ù„ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
function applyUnifiedFilter() {
    const search = document.getElementById("searchInput").value.toLowerCase();
    const type   = document.getElementById("typeFilter").value;
    const status = document.getElementById("statusFilter").value;

    const target = document.getElementById(currentCategory);
    target.innerHTML = "";

    const filtered = allProducts.filter(p => {
        if (p.category !== currentCategory) return false;
        if (search && !p.name.toLowerCase().includes(search)) return false;
        if (type && p.type !== type) return false;
        if (status && p.statusKey !== status) return false;
        return true;
    });

    if (!filtered.length) {
        target.innerHTML = `<p style="grid-column:1/-1; text-align:center; color:#555;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬.</p>`;
        return;
    }

    renderProducts(filtered, target);
}

// Ø±Ø³Ù… Ø§Ù„ÙƒØ±ÙˆØª
function renderProducts(list, container) {
    container.innerHTML = "";

    list.forEach(p => {
        let badge = `<span class="badge-status ${p.statusKey === 'available' ? 'badge-available' : 'badge-out'}">${p.statusRaw}</span>`;

        container.innerHTML += `
        <div class="card">
            <img src="${p.image}">
            <h3>${p.name}</h3>
            ${badge}
            <a class="detail-btn" href="${p.html}">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</a>
        </div>
        `;
    });
}

loadAllProducts();
</script>

</body>
</html>
