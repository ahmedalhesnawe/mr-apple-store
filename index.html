<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Mr Apple Store</title>
<style>

/* ===== Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ (CSS ÙÙ‚Ø·) ===== */
.social-icons {
    display: flex;
    align-items: center;
    gap: 12px;
}

.social-icons .icon {
    width: 38px;
    height: 38px;
    background: rgba(255,255,255,0.10);
    border: 1px solid rgba(255,255,255,0.25);
    backdrop-filter: blur(8px);
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: 0.25s ease;
    color: #fff; /* Ù…Ù‡Ù… Ø­ØªÙ‰ ÙŠÙ„ÙˆÙ† Ø§Ù„Ù€ SVG Ù„Ø£Ù†Ù‡ ÙŠØ³ØªØ®Ø¯Ù… currentColor */
    text-decoration: none;
    cursor: pointer;
}

.social-icons .icon:hover {
    background: rgba(255,255,255,0.25);
    transform: translateY(-3px);
}

/* Ø£Ù„ÙˆØ§Ù† Ø®Ø§ØµØ© Ù„Ù„Ù‡ÙÙˆÙØ± */
.icon.fb:hover { color: #1877f2; }
.icon.ig:hover { color: #ff0069; }
.icon.wa:hover { color: #25d366; }

/* ğŸ”¥ Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹ */
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 50%, #0c0c0c 100%);
    color: #e6e6e6;
}

@keyframes gradientMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* ===== Mini Banners ===== */
.mini-banners {
    display: flex;
    justify-content: space-between;
    gap: 14px;
    margin: 10px 0 25px;
}

.banner-item {
    flex: 1;
    background: rgba(255,255,255,0.16);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-radius: 16px;
    padding: 14px;
    display: flex;
    align-items: center;
    gap: 12px;
    box-shadow: 0 8px 22px rgba(0,0,0,0.40);
    transition: 0.25s;
    cursor: pointer;
    border: 1px solid rgba(255,255,255,0.28);
}

.banner-item:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 18px rgba(0,0,0,0.15);
}

.banner-item img {
    width: 48px;
    height: 48px;
}

.banner-text {
    font-size: 15px;
    color: #ffffff;
    font-weight: bold;
}

@media (max-width:768px) {
    .mini-banners {
        flex-direction: column;
    }
}

/* ===== Ø§Ù„Ù‡ÙŠØ¯Ø± ===== */
header {
    background:#0d0d0d;
    color:#fff;
    padding:12px 18px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    box-shadow:0 2px 8px rgba(0,0,0,0.3);
}

header .logo img {
    height:55px;
}

/* Ø¬Ù‡Ø© Ø§Ù„ÙŠÙ…ÙŠÙ†: Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ + Ø§Ù„Ø³Ù„Ø© + Ø§Ù„Ø­Ø³Ø§Ø¨ */
.header-right {
    display:flex;
    align-items:center;
    gap:20px;
}

.cart-link {
    color:#fff;
    font-size:16px;
    text-decoration:none;
    position:relative;
}
#cartCount {
    display:none;
    background:#ff4444;
    color:#fff;
    padding:2px 6px;
    border-radius:50%;
    font-size:12px;
    position:absolute;
    top:-6px;
    right:-10px;
}

/* ØµÙ†Ø¯ÙˆÙ‚ Ø£Ø²Ø±Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
.auth-box {
    display:flex;
    align-items:center;
    gap:8px;
}

.btn-auth,
.btn-auth-outline {
    padding:6px 12px;
    border-radius:999px;
    font-size:13px;
    cursor:pointer;
    text-decoration:none;
}

.btn-auth {
    background:#ff7a00;
    color:#fff;
    border:none;
}

.btn-auth-outline {
    background:transparent;
    color:#eee;
    border:1px solid #777;
}

.btn-auth:hover,
.btn-auth-outline:hover {
    opacity:0.9;
}

.user-welcome {
    font-size:13px;
    color:#ccc;
}

/* Ø­Ø§ÙˆÙŠØ© Ø¹Ø§Ù…Ø© Ù„Ù„Ù…Ø­ØªÙˆÙ‰ */
.main-wrap {
    max-width:1200px;
    margin:0 auto;
    padding:0 12px 40px;
    background: rgba(255, 255, 255, 0.07);
    backdrop-filter: blur(6px);
    border-radius: 18px;
    box-shadow: 0 0 25px rgba(0,0,0,0.25);
}

/* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… (ÙƒÙ„ Ø§Ù„ÙƒØ§ØªÙŠØ¬ÙˆØ±ÙŠØ² Ù…Ù† Ø§Ù„Ø´ÙŠØª) */
.products {
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(230px,1fr));
    gap:20px;
    padding:20px 0;
}

.card {
    background: rgba(255, 255, 255, 0.13);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-radius: 14px;
    padding: 12px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.35);
    text-align: center;
    border: 1px solid rgba(255,255,255,0.22);
}

.card img {
    width:100%;
    border-radius:10px;
}

.card h3 {
    font-size:18px;
    margin:10px 0;
    color: #ffffff;
}

.badge-status {
    display:inline-block;
    padding:4px 10px;
    border-radius:999px;
    font-size:12px;
    margin-top:6px;
}

.badge-available {
    background:#e6ffed;
    color:#137333;
}

.badge-out {
    background:#ffe6e6;
    color:#b00020;
}

.detail-btn {
    display:block;
    margin-top:10px;
    padding:10px;
    background:#ff7a00;
    color:white;
    border-radius:8px;
    font-size:15px;
    text-decoration:none;
}

/* ===== Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ===== */
.section-buttons {
    text-align:center;
    margin:25px 0 10px;
}

.section-buttons button {
    padding:12px 18px;
    margin:4px;
    border:none;
    border-radius:18px;
    cursor:pointer;
    background:#222;
    color:#e0e0e0;
    font-size:14px;
    transition:0.2s;
}

.section-buttons button:hover {
    background:#333;
}

.section-buttons button.active {
    background:#ff7a00;
    color:#fff;
}

/* Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ø³Ù… */
.category-title {
    text-align:center;
    margin:10px 0 15px;
    font-size:20px;
    color:#f5f5f5;
    font-weight:bold;
}

/* ===== Ø§Ù„ÙÙ„Ø§ØªØ± ===== */
.filters-bar {
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    padding:0 0 10px;
    justify-content:center;
}

.filters-bar input,
.filters-bar select {
    background:#000;
    color:#fff;
    border:1px solid #444;
    padding:10px;
    font-size:14px;
    border-radius:8px;
}

/* Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© */
.filters-bar select option {
    background:#000;
    color:#fff;
}

/* Ø£Ù‚Ø³Ø§Ù… ÙØ±Ø¹ÙŠØ© Ø¯Ø§Ø®Ù„ Ù‚Ø³Ù… Ø§Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª */
.sub-section-buttons {
    display: none;            /* Ù…Ø®ÙÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
    justify-content: center;
    flex-wrap: wrap;
    gap: 8px;
    margin: 5px 0 15px;
}

.sub-section-buttons button {
    padding:6px 12px;
    border-radius:16px;
    border:none;
    background:#151515;
    color:#e0e0e0;
    font-size:12px;
    cursor:pointer;
    transition:0.2s;
}

.sub-section-buttons button:hover {
    background:#222;
}

.sub-section-buttons button.active {
    background:#ff7a00;
    color:#fff;
}

/* ===== Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± ===== */
.slider-container {
    width:100%;
    height:480px;
    overflow:hidden;
    position:relative;
    border-radius:18px;
    margin:18px 0 28px;
    box-shadow:0 6px 18px rgba(0,0,0,0.25);
}

.slide {
    width:100%;
    height:100%;
    object-fit:cover;
    position:absolute;
    opacity:0;
    transition:opacity .8s ease;
}

.slide.active {
    opacity:1;
}

.slide-btn {
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    background:rgba(0,0,0,0.4);
    border:none;
    color:#fff;
    padding:8px 14px;
    font-size:22px;
    cursor:pointer;
    border-radius:8px;
    z-index:10;
}

.prev { left:14px; }
.next { right:14px; }

.slide-btn:hover {
    background:rgba(0,0,0,0.7);
}

@media (max-width:768px) {
    .slider-container {
        height:260px;
        margin:12px 0 18px;
        border-radius:14px;
    }
    .section-buttons {
        margin:15px 0 8px;
    }
    .products {
        padding:10px 0 25px;
        gap:14px;
    }
}

</style>
</head>
<body>

<header>
    <div class="logo">
        <img src="images/logo.png" alt="Mr Apple Logo">
    </div>

    <div class="header-right">

        <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ (SVG) -->
        <div class="social-icons">

            <!-- Facebook -->
            <a href="https://www.facebook.com/mr.apple.diw" class="icon fb">
                <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M22 12.07C22 6.48 17.52 2 11.93 2S2 6.48 2 12.07C2 17.1 5.66 21.22 10.44 22v-6.99H7.9v-2.94h2.54V9.85c0-2.5 1.49-3.89 3.77-3.89 1.09 0 2.24.2 2.24.2v2.46h-1.26c-1.24 0-1.63.77-1.63 1.56v1.87h2.78l-.44 2.94h-2.34V22c4.78-.78 8.44-4.9 8.44-9.93z"/>
                </svg>
            </a>

            <!-- Instagram -->
            <a href="https://www.instagram.com/mr.apple.diwa/" class="icon ig">
                <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M7 2C4.2 2 2 4.2 2 7v10c0 2.8 2.2 5 5 5h10c2.8 0 5-2.2 5-5V7c0-2.8-2.2-5-5-5H7zm10 2c1.7 0 3 1.3 3 3v10c0 1.7-1.3 3-3 3H7c-1.7 0-3-1.3-3-3V7c0-1.7 1.3-3 3-3h10zm-5 3.5A5.5 5.5 0 1 0 17.5 13 5.5 5.5 0 0 0 12 7.5zm0 9A3.5 3.5 0 1 1 15.5 13 3.5 3.5 0 0 1 12 16.5zm4.8-10.9a1.2 1.2 0 1 0 1.2 1.2 1.2 1.2 0 0 0-1.2-1.2z"/>
                </svg>
            </a>

            <!-- WhatsApp -->
            <a href="https://wa.link/8921a7" class="icon wa">
                <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M12.04 2C6.55 2 2.09 6.46 2.09 11.95c0 2.1.55 4.01 1.52 5.68L2 22l4.51-1.56a10.02 10.02 0 0 0 5.53 1.63h.01c5.49 0 9.95-4.46 9.95-9.95C22 6.46 17.54 2 12.04 2Zm0 17.87c-1.77 0-3.44-.52-4.88-1.51l-.35-.23-2.67.92.91-2.6-.23-.4a8.28 8.28 0 1 1 7.22 4.82Zm4.59-6.21c-.25-.12-1.47-.72-1.7-.8-.23-.08-.4-.12-.57.12-.17.25-.66.8-.81.97-.15.17-.3.18-.55.06-.25-.12-1.06-.39-2.02-1.24-.75-.67-1.26-1.49-1.41-1.74-.15-.25-.02-.38.1-.5.1-.1.25-.27.37-.4.12-.13.15-.23.23-.38.08-.15.04-.28-.02-.4-.06-.12-.57-1.37-.78-1.87-.21-.5-.42-.43-.57-.44h-.5c-.17 0-.44.06-.67.31-.23.25-.88.86-.88 2.1 0 1.24.9 2.44 1.03 2.61.13.17 1.77 2.72 4.37 3.81 2.6 1.09 2.6.73 3.07.69.47-.04 1.47-.6 1.68-1.17.21-.57.21-1.06.15-1.17-.06-.1-.23-.17-.48-.29Z"/>
                </svg>
            </a>

        </div>

        <!-- Ø§Ù„Ø³Ù„Ø© -->
        <a href="cart.html" class="cart-link">
            ğŸ›’ Ø§Ù„Ø³Ù„Ø©
            <span id="cartCount">0</span>
        </a>

        <!-- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ / Ø§Ù„Ø­Ø³Ø§Ø¨ -->
        <div class="auth-box">
            <!-- Ù‚Ø¨Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
            <a href="login.html" id="loginLink" class="btn-auth">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</a>
            <a href="register.html" id="registerLink" class="btn-auth-outline">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</a>

            <!-- Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
            <span id="userWelcome" class="user-welcome" style="display:none;"></span>
            <button id="logoutBtn" class="btn-auth-outline" style="display:none;">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </div>
    </div>
</header>

<div class="main-wrap">

    <!-- ğŸ”¥ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± -->
    <div class="slider-container">
        <button class="slide-btn prev" onclick="changeSlide(-1)">â®</button>

        <img class="slide active" src="images/slider1.png" alt="">
        <img class="slide" src="images/slider2.png" alt="">
        <img class="slide" src="images/slider3.png" alt="">
        <img class="slide" src="images/slider4.png" alt="">
        <img class="slide" src="images/slider5.png" alt="">

        <button class="slide-btn next" onclick="changeSlide(1)">â¯</button>
    </div>

    <!-- ğŸ”¥ Mini Banners -->
    <div class="mini-banners">
        <div class="banner-item">
            <img src="images/m1b.png" alt="Delivery">
            <div class="banner-text">Ø§Ù‚ÙˆÙ‰ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ù…ØªÙˆÙØ±Ø© Ø§Ù„Ø§Ù†</div>
        </div>

        <div class="banner-item">
            <img src="images/m2b.png" alt="Original">
            <div class="banner-text">Ø§Ù‚ÙˆÙ‰ Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„</div>
        </div>

        <div class="banner-item">
            <img src="images/m3b.png" alt="Sale">
            <div class="banner-text">Ø§Ù„ØªÙˆØµÙŠÙ„ Ø§Ø³Ø±Ø¹ Ù…Ù† Ø§Ù„Ø³Ø±ÙŠØ¹ ğŸ”¥</div>
        </div>
    </div>

    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø³Ù… -->
    <div class="section-buttons">
        <button id="btnApple" onclick="switchCategory('apple')" class="active">Ù…Ù†ØªØ¬Ø§Øª Apple</button>
        <button id="btnSamsung" onclick="switchCategory('samsung')">Ù…Ù†ØªØ¬Ø§Øª Samsung</button>
        <button id="btnRealme" onclick="switchCategory('realme')">Ù…Ù†ØªØ¬Ø§Øª Realme</button>
        <button id="btnXiaomi" onclick="switchCategory('xiaomi')">Ù…Ù†ØªØ¬Ø§Øª Xiaomi & POCO</button>
        <button id="btnHonor" onclick="switchCategory('honor')">Ù…Ù†ØªØ¬Ø§Øª Honor</button>
        <button id="btnHuawei" onclick="switchCategory('huawei')">Ø³Ø§Ø¹Ø§Øª Huawei</button>
        <button id="btnAccessories" onclick="switchCategory('accessories')">Ø§Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª</button>
    </div>

    <!-- Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ -->
    <h2 id="categoryTitle" class="category-title">Ù…Ù†ØªØ¬Ø§Øª Apple</h2>

    <!-- Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…ÙˆØ­Ø¯Ø© -->
    <div class="filters-bar">
        <input id="searchInput" type="text" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." oninput="applyUnifiedFilter()">

        <select id="typeFilter" onchange="applyUnifiedFilter()">
            <option value="">ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
        </select>

        <select id="statusFilter" onchange="applyUnifiedFilter()">
            <option value="">Ø§Ù„Ø­Ø§Ù„Ø©: Ø§Ù„ÙƒÙ„</option>
            <option value="available">Ù…ØªÙˆÙØ± ÙÙ‚Ø·</option>
            <option value="out">ØºÙŠØ± Ù…ØªÙˆÙØ± ÙÙ‚Ø·</option>
        </select>
    </div>

    <!-- Ø£Ù‚Ø³Ø§Ù… ÙØ±Ø¹ÙŠØ© Ø®Ø§ØµØ© Ø¨Ù‚Ø³Ù… Ø§Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª -->
    <div id="accessoriesSub" class="sub-section-buttons"></div>

    <!-- Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ù…Ù† Ø§Ù„Ø´ÙŠØª -->
    <section id="apple" class="products"></section>
    <section id="samsung" class="products" style="display:none;"></section>
    <section id="realme" class="products" style="display:none;"></section>
    <section id="xiaomi" class="products" style="display:none;"></section>
    <section id="honor" class="products" style="display:none;"></section>
    <section id="huawei" class="products" style="display:none;"></section>
    <section id="accessories" class="products" style="display:none;"></section>

</div> <!-- end .main-wrap -->

<script src="cart.js"></script>

<script>
// ===== Ø³Ù„Ø§ÙŠØ¯Ø± =====
let currentSlide = 0;
const slides = document.querySelectorAll(".slide");

function showSlide(index) {
    slides.forEach(s => s.classList.remove('active'));
    slides[index].classList.add('active');
}

function changeSlide(step) {
    currentSlide = (currentSlide + step + slides.length) % slides.length;
    showSlide(currentSlide);
}

setInterval(() => { changeSlide(1); }, 5000);

// ===== Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Google Sheet =====
const SHEET_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vQy4WWb2dGNoPn7G0mirIaYLF0p80wjsO7X7uEKMiFgubBXvN_QxiPBwl4HrAcotkjBkZ98UDf_GoST/pub?output=csv";

let allProducts = [];
let currentCategory = "apple";

const categoryTitleEl = document.getElementById('categoryTitle');
const categoryTitles = {
    apple: "Ù…Ù†ØªØ¬Ø§Øª Apple",
    samsung: "Ù…Ù†ØªØ¬Ø§Øª Samsung",
    realme: "Ù…Ù†ØªØ¬Ø§Øª Realme",
    xiaomi: "Ù…Ù†ØªØ¬Ø§Øª Xiaomi & POCO",
    honor: "Ù…Ù†ØªØ¬Ø§Øª Honor",
    huawei: "Ø³Ø§Ø¹Ø§Øª Huawei",
    accessories: "Ø§Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª"
};

// ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
async function loadAllProducts() {
    const res = await fetch(SHEET_URL);
    const text = await res.text();
    const lines = text.trim().split("\n");
    lines.shift(); // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†

    allProducts = [];

    lines.forEach(line => {
        const cols = line.split(",");

        const category = (cols[1] || "").trim().toLowerCase();
        const name     = (cols[2] || "").trim();
        const html     = (cols[3] || "").trim();
        const image    = (cols[4] || "").trim();
        const status   = (cols[7] || "").trim();
        const type     = (cols[8] || "").trim();

        if (!name) return;

        allProducts.push({
            category,
            name,
            html,
            image,
            type,
            statusKey: status === "Ù…ØªÙˆÙØ±" ? "available" : "out",
            statusRaw: status
        });
    });

    // ØªØµØ­ÙŠØ­ Ø§Ø³Ù… iPhone 17 Pro Ù„Ùˆ Ø·Ø§Ù„Ø¹ ØºÙ„Ø· Ù…Ù† Ø§Ù„Ø´ÙŠØª
    allProducts.forEach(p => {
        if (p.html.toLowerCase() === "iphone17pro.html") {
            p.name = "iPhone 17 Pro";
        }
    });

    buildTypeList();
    applyUnifiedFilter();
    buildAccessoriesSubCategories(); // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ÙØ±Ø¹ÙŠØ© Ù„Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª
}

// ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ Ù„Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ø¹Ø§Ù…Ø©
function buildTypeList() {
    const used = new Set();
    allProducts.forEach(p => { if (p.type) used.add(p.type); });

    const sel = document.getElementById("typeFilter");
    sel.innerHTML = `<option value="">ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>`;

    used.forEach(t => {
        sel.innerHTML += `<option value="${t}">${t}</option>`;
    });
}

// Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ÙØ±Ø¹ÙŠØ© Ù„Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª ÙÙ‚Ø·
function buildAccessoriesSubCategories() {
    const subWrap = document.getElementById('accessoriesSub');
    if (!subWrap) return;

    const types = new Set();
    allProducts.forEach(p => {
        if (p.category === 'accessories' && p.type) {
            types.add(p.type);
        }
    });

    subWrap.innerHTML = "";

    if (!types.size) {
        subWrap.style.display = "none";
        return;
    }

    // Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ Ù…Ø®ÙÙŠØ©ØŒ ØªØ¸Ù‡Ø± ÙÙ‚Ø· Ø¹Ù†Ø¯ ÙØªØ­ Ù‚Ø³Ù… Ø§Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª
    subWrap.style.display = "none";

    // Ø²Ø± "Ø§Ù„ÙƒÙ„"
    subWrap.innerHTML += `<button data-type="" class="active">Ø§Ù„ÙƒÙ„</button>`;

    // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹
    types.forEach(t => {
        subWrap.innerHTML += `<button data-type="${t}">${t}</button>`;
    });

    const typeSelect = document.getElementById("typeFilter");

    subWrap.querySelectorAll("button").forEach(btn => {
        btn.addEventListener("click", () => {
            // ØªØºÙŠÙŠØ± Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ù†Ø´Ø·
            subWrap.querySelectorAll("button").forEach(b => b.classList.remove("active"));
            btn.classList.add("active");

            // Ø¶Ø¨Ø· Ù‚ÙŠÙ…Ø© Ø§Ù„ÙÙ„ØªØ± typeFilter
            const val = btn.getAttribute("data-type") || "";
            if (typeSelect) {
                typeSelect.value = val;
            }

            applyUnifiedFilter();
        });
    });
}

// ØªØºÙŠÙŠØ± Ø§Ù„Ù‚Ø³Ù…
function switchCategory(cat) {
    currentCategory = cat;

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
    categoryTitleEl.textContent = categoryTitles[cat] || "Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª";

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    document.querySelectorAll(".section-buttons button").forEach(b => b.classList.remove("active"));

    if (cat === "apple")      document.getElementById("btnApple").classList.add("active");
    if (cat === "samsung")    document.getElementById("btnSamsung").classList.add("active");
    if (cat === "realme")     document.getElementById("btnRealme").classList.add("active");
    if (cat === "xiaomi")     document.getElementById("btnXiaomi").classList.add("active");
    if (cat === "honor")      document.getElementById("btnHonor").classList.add("active");
    if (cat === "huawei")     document.getElementById("btnHuawei").classList.add("active");
    if (cat === "accessories")document.getElementById("btnAccessories").classList.add("active");

    // Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
    document.getElementById("apple").style.display = "none";
    document.getElementById("samsung").style.display = "none";
    document.getElementById("realme").style.display = "none";
    document.getElementById("xiaomi").style.display = "none";
    document.getElementById("honor").style.display = "none";
    document.getElementById("huawei").style.display = "none";
    document.getElementById("accessories").style.display = "none";

    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø®ØªØ§Ø±
    document.getElementById(cat).style.display = "grid";

    // Ø¥Ø¸Ù‡Ø§Ø± / Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ÙØ±Ø¹ÙŠØ© Ù„Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª
    const accessoriesSub = document.getElementById('accessoriesSub');
    if (accessoriesSub) {
        if (cat === 'accessories' && accessoriesSub.children.length > 0) {
            accessoriesSub.style.display = 'flex';
        } else {
            accessoriesSub.style.display = 'none';
        }
    }

    applyUnifiedFilter();
}

// ÙÙ„ØªØ± Ù…ÙˆØ­Ø¯ Ù„ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
function applyUnifiedFilter() {
    const search = document.getElementById("searchInput").value.toLowerCase();
    const type   = document.getElementById("typeFilter").value;
    const status = document.getElementById("statusFilter").value;

    const target = document.getElementById(currentCategory);
    target.innerHTML = "";

    const filtered = allProducts.filter(p => {
        if (p.category !== currentCategory) return false;
        if (search && !p.name.toLowerCase().includes(search)) return false;
        if (type && p.type !== type) return false;
        if (status && p.statusKey !== status) return false;
        return true;
    });

    if (!filtered.length) {
        target.innerHTML = `<p style="grid-column:1/-1; text-align:center; color:#bbb;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬.</p>`;
        return;
    }

    renderProducts(filtered, target);
}

// Ø±Ø³Ù… Ø§Ù„ÙƒØ±ÙˆØª
function renderProducts(list, container) {
    container.innerHTML = "";

    list.forEach(p => {
        let badge = `<span class="badge-status ${p.statusKey === 'available' ? 'badge-available' : 'badge-out'}">${p.statusRaw}</span>`;

        let detailBtnHtml = "";

        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¥ÙƒØ³Ø³ÙˆØ§Ø± ÙˆÙ…Ø§ Ø¹Ù†Ø¯Ù‡ ØµÙØ­Ø© HTML â†’ Ø®Ù„ÙŠ Ø§Ù„Ø²Ø± ÙŠØ±ÙˆØ­ ÙˆØ§ØªØ³Ø§Ø¨
        if (p.category === "accessories" && (!p.html || p.html === "#")) {

            const waLink = "https://wa.me/9647812349544?text="
                + encodeURIComponent("Ø£Ø±ÙŠØ¯ ØªÙØ§ØµÙŠÙ„ Ø¹Ù†: " + p.name);

            detailBtnHtml = `
                <a class="detail-btn" href="${waLink}" target="_blank">
                    Ø§Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
                </a>
            `;
        } else {
            // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø£Ùˆ Ø§Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø§Ù„Ù„ÙŠ Ø¥Ù„Ù‡Ø§ ØµÙØ­Ø© HTML
            detailBtnHtml = `
                <a class="detail-btn" href="${p.html}">
                    Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„
                </a>
            `;
        }

        container.innerHTML += `
        <div class="card">
            <img src="${p.image}" alt="${p.name}">
            <h3>${p.name}</h3>
            ${badge}
            ${detailBtnHtml}
        </div>
        `;
    });
}


loadAllProducts();
</script>

<!-- âœ… Firebase + Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-auth-compat.js"></script>
<script src="firebase-init.js"></script>

<script>
auth.onAuthStateChanged(function(user) {

    const loginLink    = document.getElementById('loginLink');
    const registerLink = document.getElementById('registerLink');
    const userWelcome  = document.getElementById('userWelcome');
    const logoutBtn    = document.getElementById('logoutBtn');

    if (user) {
        const name = user.displayName || user.email;

        if (loginLink)    loginLink.style.display = "none";
        if (registerLink) registerLink.style.display = "none";

        if (userWelcome) {
            userWelcome.textContent = "Ù…Ø±Ø­Ø¨Ø§ØŒ " + name;
            userWelcome.style.display = "inline-block";
        }

        if (logoutBtn) {
            logoutBtn.style.display = "inline-block";
            logoutBtn.onclick = function () {
                auth.signOut().then(() => {
                    window.location.reload();
                });
            };
        }
    } else {
        if (loginLink)    loginLink.style.display = "inline-block";
        if (registerLink) registerLink.style.display = "inline-block";
        if (userWelcome)  userWelcome.style.display = "none";
        if (logoutBtn)    logoutBtn.style.display = "none";
    }
});
</script>

</body>
</html>
