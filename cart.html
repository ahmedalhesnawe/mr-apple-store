<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª â€“ Ù…Ø³ØªØ± Ø£Ø¨Ù„</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: radial-gradient(circle at top, #222 0, #050505 45%, #000 100%);
            color: #fff;
        }

        .top-bar {
            background:#000;
            padding:10px 20px;
            display:flex;
            align-items:center;
            justify-content:space-between;
        }

        .top-bar .logo { font-weight:bold; font-size:18px; }
        .top-bar a { color:#aaa; text-decoration:none; font-size:14px; }

        /* Ø²Ø± Ø§Ù„Ø³Ù„Ø© ÙÙŠ Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .cart-link {
            color:#fff !important;
            font-size:16px;
            text-decoration:none;
            position:relative;
            display:flex;
            align-items:center;
            gap:6px;
        }

        #cartCount {
            display:none;
            background:#ff4444;
            color:#fff;
            padding:2px 6px;
            border-radius:50%;
            font-size:12px;
            position:absolute;
            top:-6px;
            right:-10px;
        }

        .page-wrap {
            max-width: 1100px;
            margin: 30px auto 40px;
            padding: 0 20px;
        }

        h1 {
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 28px;
        }

        .empty-msg {
            padding: 20px;
            background:#111;
            border-radius:10px;
            text-align:center;
            margin-top:20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom:20px;
            background:#111;
            border-radius:12px;
            overflow:hidden;
        }

        th, td {
            padding:10px;
            border-bottom:1px solid #333;
            text-align:center;
            font-size:14px;
        }

        th {
            background:#000;
        }

        tr:last-child td {
            border-bottom:none;
        }

        .qty-btn {
            padding:4px 9px;
            border:none;
            border-radius:6px;
            cursor:pointer;
            background:#333;
            color:#fff;
            font-size:14px;
        }

        .qty-value {
            margin:0 6px;
            min-width:24px;
            display:inline-block;
        }

        .remove-btn {
            padding:5px 10px;
            border:none;
            border-radius:6px;
            cursor:pointer;
            background:#b00020;
            color:#fff;
            font-size:13px;
        }

        .actions {
            display:flex;
            justify-content:space-between;
            align-items:center;
            flex-wrap:wrap;
            gap:10px;
            margin-top:15px;
        }

        .total-box {
            font-size:18px;
            font-weight:bold;
        }

        .btn-clear,
        .btn-whatsapp {
            padding:10px 16px;
            border:none;
            border-radius:8px;
            cursor:pointer;
            font-size:14px;
        }

        .btn-clear {
            background:#444;
            color:#fff;
        }

        .btn-whatsapp {
            background:#25d366;
            color:#fff;
        }

        .btn-clear:hover,
        .btn-whatsapp:hover {
            opacity:0.9;
        }

        .back-link {
            color:#8ab4ff;
            text-decoration:none;
            display:inline-block;
            margin-top:20px;
        }
    </style>
</head>
<body>

<header class="top-bar">
    <a href="index.html" class="logo">
        <img src="images/logo.png" alt="Mr Apple Logo" style="height:80px;">
    </a>

    <div style="display:flex; align-items:center; gap:25px;">
        <!-- Ø²Ø± Ø§Ù„Ø³Ù„Ø© ÙÙŠ Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <a href="cart.html" class="cart-link">
            ğŸ›’ Ø§Ù„Ø³Ù„Ø©
            <span id="cartCount">0</span>
        </a>

        <a href="index.html">Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…ØªØ¬Ø±</a>
    </div>
</header>

<div class="page-wrap">
    <h1>Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h1>

    <div id="emptyBox" class="empty-msg" style="display:none;">
        Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ© Ø­Ø§Ù„ÙŠØ§Ù‹ ğŸ›’<br>
        ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø£Ùˆ ØµÙØ­Ø§Øª Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©.
    </div>

    <table id="cartTable" style="display:none;">
        <thead>
            <tr>
                <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
                <th>Ø§Ù„Ø³Ø¹Ø©</th>
                <th>Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬</th>
                <th>Ø§Ù„Ù„ÙˆÙ†</th>
                <th>Ø§Ù„Ø³Ø¹Ø±</th>
                <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                <th>Ø¥Ø²Ø§Ù„Ø©</th>
            </tr>
        </thead>
        <tbody id="cartBody">
            <!-- ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
        </tbody>
    </table>

    <div class="actions" id="actionsBox" style="display:none;">
        <div class="total-box">
            Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: <span id="cartTotal">0 IQD</span>
        </div>

        <div style="display:flex; gap:10px; flex-wrap:wrap;">
            <button class="btn-clear" onclick="clearCart()">ğŸ—‘ ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©</button>
            <button class="btn-whatsapp" onclick="sendOrderOnWhatsApp()">ğŸ“² Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
        </div>
    </div>

    <a href="index.html" class="back-link">ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ØªØ¬Ø±</a>
</div>

<!-- ØªØ­Ù…ÙŠÙ„ Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø³Ù„Ø© Ø§Ù„Ø¹Ø§Ù… -->
<script src="cart.js"></script>

<script>
const CART_KEY = 'mrAppleCart';

function loadCart() {
    try {
        const data = localStorage.getItem(CART_KEY);
        return data ? JSON.parse(data) : [];
    } catch(e) {
        return [];
    }
}

function saveCart(cart) {
    localStorage.setItem(CART_KEY, JSON.stringify(cart));
    // Ø¥Ø°Ø§ Ø¹Ù†Ø¯Ùƒ Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« ÙÙŠ cart.js Ù†Ø³ØªØ¯Ø¹ÙŠÙ‡Ø§
    if (typeof updateCartCount === 'function') {
        updateCartCount();
    }
}

function formatPrice(num) {
    if (!num || isNaN(num)) return '0 IQD';
    // 1.390.000 Ø´ÙƒÙ„ Ø¹Ø±Ø§Ù‚ÙŠ
    return num.toLocaleString('de-DE') + ' IQD';
}

function renderCart() {
    const cart = loadCart();
    const cartTable   = document.getElementById('cartTable');
    const cartBody    = document.getElementById('cartBody');
    const emptyBox    = document.getElementById('emptyBox');
    const actionsBox  = document.getElementById('actionsBox');
    const totalSpan   = document.getElementById('cartTotal');

    cartBody.innerHTML = '';

    if (!cart.length) {
        cartTable.style.display  = 'none';
        actionsBox.style.display = 'none';
        emptyBox.style.display   = 'block';
        totalSpan.textContent    = '0 IQD';
        return;
    }

    cartTable.style.display  = 'table';
    actionsBox.style.display = 'flex';
    emptyBox.style.display   = 'none';

    let total = 0;

    cart.forEach((item, index) => {
        const qty = item.qty || 1;
        const price = item.price || 0;
        total += price * qty;

        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td>${item.name || ''}</td>
            <td>${item.capacity || '-'}</td>
            <td>${item.chip || '-'}</td>
            <td>${item.color || '-'}</td>
            <td>${formatPrice(price)}</td>
            <td>
                <button class="qty-btn" onclick="changeQty(${index}, -1)">-</button>
                <span class="qty-value">${qty}</span>
                <button class="qty-btn" onclick="changeQty(${index}, 1)">+</button>
            </td>
            <td>
                <button class="remove-btn" onclick="removeItem(${index})">âœ•</button>
            </td>
        `;
        cartBody.appendChild(tr);
    });

    totalSpan.textContent = formatPrice(total);
}

function changeQty(index, delta) {
    const cart = loadCart();
    if (!cart[index]) return;

    const current = cart[index].qty || 1;
    const next = current + delta;
    if (next <= 0) {
        // Ø¥Ø°Ø§ ØµØ§Ø±Øª ØµÙØ± Ù†Ø­Ø°Ù Ø§Ù„Ø¹Ù†ØµØ±
        cart.splice(index, 1);
    } else {
        cart[index].qty = next;
    }

    saveCart(cart);
    renderCart();
}

function removeItem(index) {
    const cart = loadCart();
    if (!cart[index]) return;

    cart.splice(index, 1);
    saveCart(cart);
    renderCart();
}

function clearCart() {
    if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ')) return;
    saveCart([]);
    renderCart();
}

function sendOrderOnWhatsApp() {
    const cart = loadCart();
    if (!cart.length) {
        alert('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©ØŒ Ø£Ø¶Ù Ù…Ù†ØªØ¬Ø§Øª Ø£ÙˆÙ„Ø§Ù‹.');
        return;
    }

    let total = 0;
    const lines = [];

    lines.push('Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù…ÙˆÙ‚Ø¹ Ù…Ø³ØªØ± Ø£Ø¨Ù„:');
    lines.push('---------------------------');

    cart.forEach((item, i) => {
        const qty   = item.qty || 1;
        const price = item.price || 0;
        total += price * qty;

        let line = `${i+1}) ${item.name || ''}`;
        if (item.capacity) line += ` - ${item.capacity}`;
        if (item.chip)     line += ` - Ù…Ø¹Ø§Ù„Ø¬: ${item.chip}`;
        if (item.color)    line += ` - Ù„ÙˆÙ†: ${item.color}`;
        line += ` - Ø§Ù„ÙƒÙ…ÙŠØ©: ${qty}`;
        line += ` - Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙØ±Ø¯ÙŠ: ${formatPrice(price)}`;

        lines.push(line);
    });

    lines.push('---------------------------');
    lines.push(`Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${formatPrice(total)}`);
    lines.push('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ·Ø±Ù‚ Ø§Ù„ØªÙˆØµÙŠÙ„ ÙˆØ§Ù„Ø¯ÙØ¹.');

    const message = lines.join('\n');

    // Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ (ØªØ¹Ø¯Ù„Ù‡ Ø¥Ø°Ø§ ØªØ­Ø¨)
    const phone = '9647812349544';
    const url = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;

    window.open(url, '_blank');
}

// Ø£ÙˆÙ„ ØªØ´ØºÙŠÙ„
renderCart();
</script>

</body>
</html>
